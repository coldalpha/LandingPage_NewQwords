!function(d,g){g.wp.gdrts.core.stars_rating={run:function(){wp.gdrts.hooks.addAction("gdrts-core-common-methods-run",function(t,s){g.wp.gdrts.core.stars_rating.single.init(s),g.wp.gdrts.core.stars_rating.list.init(s)}),wp.gdrts.hooks.addAction("gdrts-dynamic-process-onload",function(t){d(t).hasClass("gdrts-method-stars-rating")&&g.wp.gdrts.core.stars_rating.single.process(d(".gdrts-stars-rating",t))})},single:{init:function(t){d(".gdrts-rating-block .gdrts-stars-rating",t).each(function(){g.wp.gdrts.core.stars_rating.single.process(this)})},call:function(t,s){var r=g.wp.gdrts.core._b(t),t=g.wp.gdrts.core._d(t),t={todo:"vote",method:"stars-rating",item:t.item.item_id,nonce:t.item.nonce,render:t.render,uid:t.uid,meta:{value:s,max:t.stars.max}};wp.gdrts.hooks.doAction("gdrts-rating-method-pre-ajax","stars-rating",r,t),g.wp.gdrts.help.remote.call(t,g.wp.gdrts.core.stars_rating.single.voted,g.wp.gdrts.help.remote.error)},voted:function(t){var s;"error"===t.status?g.wp.gdrts.core.common.error(t):(s=d(t.render).hide(),d("#gdrts-unique-id-"+t.uid).fadeOut(150,function(){d(this).replaceWith(s),s.fadeIn(300,function(){g.wp.gdrts.core.common.process(this),g.wp.gdrts.core.stars_rating.single.process(d(".gdrts-stars-rating",this)),d(this).attr("role","alert"),wp.gdrts.hooks.doAction("gdrts-stars-rating-voted",d(this)),wp.gdrts.hooks.doAction("gdrts-rating-block-loaded",d(this),"stars-rating")})}))},process:function(t){var s,r,a,e;d(t).data().hasOwnProperty("gdrts")||(d(t).data("gdrts","done"),s=g.wp.gdrts.core._d(t).stars,r=g.wp.gdrts.core._d(t).labels,d(t).hasClass("gdrts-with-fonticon")&&(a=s.type+"-"+s.name+"-"+s.max,e={font:s.name,name:s.type,length:s.max,content:Array(s.max+1).join(g.wp.gdrts.help.char(s.char))},g.wp.gdrts.core.style.star(a,e)),d(t).hasClass("gdrts-state-active")&&g.wp.gdrts.core.stars_rating.single.activity(t,s,r),s.responsive&&(d(g).on("load resize orientationchange",{el:t,data:s},g.wp.gdrts.core.responsive.stars),g.wp.gdrts.core.responsive._s({el:t,data:s})),wp.gdrts.hooks.doAction("gdrts-stars-rating-single-init",t))},activity:function(n,i,o){d(".gdrts-stars-empty",n).mouseleave(function(t){var s,r;d(this).hasClass("gdrts-vote-saving")||(s=d(this).parent().find("input").val(),r=d(this).width()/i.max*s,d(n).data("selected",s).attr("title",""),d(".gdrts-stars-active",this).width(r))}),d(".gdrts-stars-empty",n).mousemove(function(t){var s,r,a,e;d(this).hasClass("gdrts-vote-saving")||(r=d(this).offset(),s=d(this).width()/i.max,a=i.resolution,s=i.max*s/(e=a*(s/100)),r=t.pageX-r.left,s=gdrts_rating_data.rtl?s-Math.ceil(r/e)+1:Math.ceil(r/e),r=parseFloat((s*(a/100)).toFixed(2)),a=Math.ceil(+r),a=o[a-1],e=s*e,d(n).data("selected",r).attr("title",r+": "+a),d(".gdrts-stars-active",this).width(e))}),d(".gdrts-sr-button",n).click(function(t){t.preventDefault();t=d(this).parent().find(".gdrts-sr-rating");g.wp.gdrts.core.stars_rating.single.do_rating(d(t).val(),t.parent(),n)}),d(".gdrts-stars-empty",n).click(function(t){t.preventDefault(),g.wp.gdrts.core.stars_rating.single.do_rating(d(n).data("selected"),this,n)})},do_rating:function(t,s,r){var a;d(s).hasClass("gdrts-vote-saving")||(d(s).parent().find("input").val(t),d(s).parent().hasClass("gdrts-passive-rating")||(a=g.wp.gdrts.core._b(r),wp.gdrts.hooks.applyFilters("gdrts-stars-rating-do-vote",!0,t,a)?(d(s).addClass("gdrts-vote-saving"),g.wp.gdrts.core._b(d(s).parent()).addClass("gdrts-vote-saving"),g.wp.gdrts.core.stars_rating.single.call(r,t)):wp.gdrts.hooks.doAction("gdrts-stars-rating-vote-prevented",t,a)))}},list:{init:function(t){d(".gdrts-rating-list .gdrts-stars-rating",t).each(function(){g.wp.gdrts.core.stars_rating.list.process(this)})},process:function(t){var s,r,a;d(t).data().hasOwnProperty("gdrts")||(d(t).data("gdrts","done"),s=g.wp.gdrts.core._d(t).stars,d(t).hasClass("gdrts-with-fonticon")&&(r=s.type+"-"+s.name+"-"+s.max,a={font:s.name,name:s.type,length:s.max,content:Array(s.max+1).join(g.wp.gdrts.help.char(s.char))},g.wp.gdrts.core.style.star(r,a)),s.responsive&&(d(g).on("load resize orientationchange",{el:t,data:s},g.wp.gdrts.core.responsive.stars),g.wp.gdrts.core.responsive._s({el:t,data:s})),wp.gdrts.hooks.doAction("gdrts-stars-rating-list-init",t))}}},g.wp.gdrts.core.stars_rating.run()}(jQuery,window,document);